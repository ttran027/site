@page "/"
@page "/profile"
@using Client.CQRS.Queries
@using Client.Components.Resume

<PageTitle>Profile Page</PageTitle>
@if (!_loading)
{
    <ResumeComponent Resume="@Resume"/>
}
else
{
    <MudProgressCircular Indeterminate />
}


@code {
    private ResumeDetails? Resume;
    private bool _loading;

    [Inject]
    private IMediator Mediator { get; set; } = null!;

    [Inject]
    private ISnackbar Snackbar { get; set; } = null!;

    protected override async Task OnInitializedAsync()
    {
        _loading = true;
        var result = await Mediator.Send(new ResumeQuery());
        if (result.IsSuccess)
        {
            Resume = result.Value;
        }
        else
        {
            Resume = null;
            Snackbar.Add(string.Concat(result.Errors));
        }
        _loading = false;
    }
}